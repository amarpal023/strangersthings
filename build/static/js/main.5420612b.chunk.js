(this.webpackJsonpstrangersthings=this.webpackJsonpstrangersthings||[]).push([[0],{31:function(e,t,s){"use strict";s.r(t);var n=s(1),c=s(17),r=s.n(c),a=s(7),o=s(4),l=s.n(o),i=s(6),j=s(3),u=s(2),d=function(){var e=Object(i.a)(l.a.mark((function e(t){var s,n,c,r,a,o,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=t.url,n=t.method,c=t.token,r=t.body,e.prev=1,a={method:n?n.toUpperCase():"GET",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)},c&&(a.headers.Authorization="Bearer ".concat(c)),console.log("options: ",a),e.next=7,fetch("".concat("https://strangers-things.herokuapp.com/api/2105-SJS-RM-WEB-PT").concat(s),a);case 7:return o=e.sent,e.next=10,o.json();case 10:if(!(i=e.sent).error){e.next=13;break}throw i.error;case 13:return e.abrupt("return",i);case 16:e.prev=16,e.t0=e.catch(1),console.error(e.t0);case 19:case"end":return e.stop()}}),e,null,[[1,16]])})));return function(t){return e.apply(this,arguments)}}(),b=s(0),p=function(e){var t=e.setToken,s=e.setUser,c=e.setMessages,r=e.setUserId,o=Object(n.useState)(""),p=Object(j.a)(o,2),h=p[0],O=p[1],x=Object(n.useState)(""),m=Object(j.a)(x,2),f=m[0],v=m[1],g=Object(n.useState)(""),k=Object(j.a)(g,2),y=k[0],N=k[1],S=Object(u.f)(),w=Object(u.e)();return Object(b.jsx)(b.Fragment,{children:Object(b.jsx)("form",{onSubmit:function(){var e=Object(i.a)(l.a.mark((function e(n){var a,o,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.prev=1,a="".concat("https://strangers-things.herokuapp.com/api/2105-SJS-RM-WEB-PT","/users/").concat(S.method),console.log("fetchUrl: ",a),e.next=6,d({url:"/users/".concat(S.method),method:"POST",body:{user:{username:h,password:f}}});case 6:if(o=e.sent,console.log("loginResp: ",o),!o.data){e.next=18;break}return e.next=11,d({url:"/users/me",token:o.data.token});case 11:i=e.sent,t(o.data.token),s(i.data.username),c(i.data.messages),r(i.data._id),console.log("userResp.data: ",i.data),o.data.token&&w.push("/");case 18:e.next=26;break;case 20:e.prev=20,e.t0=e.catch(1),console.error(e.t0),alert("Invalid Username or Password. The information you've entered doesn't match any account. Please use the link below to register for an account."),O(""),v("");case 26:case"end":return e.stop()}}),e,null,[[1,20]])})));return function(t){return e.apply(this,arguments)}}(),children:Object(b.jsxs)("div",{className:"container",children:[Object(b.jsx)("h1",{className:"loginheader",children:Object(b.jsx)("div",{children:S.method})}),Object(b.jsx)("br",{}),Object(b.jsx)("input",{type:"text",placeholder:" username",value:h,onChange:function(e){return O(e.target.value)}}),Object(b.jsx)("br",{}),Object(b.jsx)("input",{type:"password",placeholder:" password",value:f,onChange:function(e){return v(e.target.value)}}),Object(b.jsx)("br",{}),"register"===S.method?Object(b.jsx)("input",{type:"password",placeholder:"retype your password",value:y,onChange:function(e){return N(e.target.value)}}):"","register"===S.method?Object(b.jsx)("button",{type:"submit",disabled:!f||!h||f!==y,children:"Submit"}):Object(b.jsx)("button",{type:"submit",disabled:!f||!h,children:"Submit"}),"login"===S.method?Object(b.jsx)(a.b,{to:"/account/register",className:"registerhere",children:"Click here to register"}):Object(b.jsx)(a.b,{to:"/account/login",children:"Click here to login"})]})})})},h=function(e){var t=e.token,s=e.setPosts,c=Object(n.useState)(""),r=Object(j.a)(c,2),a=r[0],o=r[1],u=Object(n.useState)(""),p=Object(j.a)(u,2),h=p[0],O=p[1],x=Object(n.useState)(""),m=Object(j.a)(x,2),f=m[0],v=m[1],g=Object(n.useState)(""),k=Object(j.a)(g,2),y=k[0],N=k[1],S=Object(n.useState)(!1),w=Object(j.a)(S,2),P=w[0],C=w[1],D=function(){var e=Object(i.a)(l.a.mark((function e(n){var c,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),console.log({location:y,description:h}),e.next=4,d({url:"/posts",method:"POST",token:t,body:{post:{title:a,description:h,price:f,location:y,willDeliver:P}}});case 4:return c=e.sent,console.log("postResp: ",c),e.next=8,d({url:"/posts",token:t});case 8:r=e.sent,console.log("postsResp: ",r),s(r.data.posts);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(b.jsx)(b.Fragment,{children:Object(b.jsxs)("div",{className:"addform",children:[Object(b.jsx)("h1",{children:"Add post"}),Object(b.jsxs)("form",{onSubmit:D,children:[Object(b.jsxs)("fieldset",{children:[Object(b.jsx)("label",{className:"addformlabel",children:"Title: "}),Object(b.jsx)("input",{type:"text",placeholder:" title",value:a,onChange:function(e){return o(e.target.value)}})]}),Object(b.jsxs)("fieldset",{children:[Object(b.jsx)("label",{className:"addformlabel",children:"Description: "}),Object(b.jsx)("input",{type:"text",placeholder:" description",value:h,onChange:function(e){return O(e.target.value)}})]}),Object(b.jsxs)("fieldset",{children:[Object(b.jsx)("label",{className:"addformlabel",children:"Price: "}),Object(b.jsx)("input",{type:"text",placeholder:" price",value:f,onChange:function(e){return v(e.target.value)}})]}),Object(b.jsxs)("fieldset",{children:[Object(b.jsx)("label",{className:"addformlabel",children:"Location: "}),Object(b.jsx)("input",{type:"text",placeholder:" location",value:y,onChange:function(e){return N(e.target.value)}})]}),Object(b.jsxs)("fieldset",{children:[Object(b.jsx)("label",{className:"addformlabel",children:"Will Deliver: "}),Object(b.jsxs)("select",{type:"text",value:P,onChange:function(e){return C(e.target.value)},children:[Object(b.jsx)("option",{value:"false",children:"No"}),Object(b.jsx)("option",{value:"true",children:"Yes"})]})]}),Object(b.jsx)("button",{type:"submit",children:"Add post"})]})]})})},O=function(){var e=Object(n.useState)(""),t=Object(j.a)(e,2),s=t[0],c=t[1],r=Object(n.useState)(""),o=Object(j.a)(r,2),O=o[0],x=o[1],v=Object(n.useState)([]),S=Object(j.a)(v,2),w=S[0],P=S[1],C=Object(n.useState)([]),D=Object(j.a)(C,2),T=D[0],I=D[1],U=Object(n.useState)(""),_=Object(j.a)(U,2),F=_[0],M=_[1];console.log("user: ",O),console.log("posts: ",w),console.log("messages: ",T),console.log("userId: ",F);var A=function(){var e=Object(i.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d({url:"/posts",token:s});case 2:t=e.sent,(n=t.data.posts)&&P(n);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(n.useEffect)((function(){try{A()}catch(e){console.error(e)}}),[s]),Object(b.jsxs)(b.Fragment,{children:[Object(b.jsxs)("header",{className:"site-banner",children:[Object(b.jsx)(a.b,{to:"/",className:"emblem",children:Object(b.jsx)("h1",{children:"Stranger's Things"})}),Object(b.jsxs)("div",{className:"nav-bar",children:[Object(b.jsx)(a.b,{to:"/",className:"nav-link",children:"Home"}),Object(b.jsx)(a.b,{to:"/posts",className:"nav-link",children:"Posts"}),s?Object(b.jsx)(a.b,{to:"/profile",className:"nav-link",children:"Profile"}):"",s?Object(b.jsx)(a.b,{to:"/account/login",className:"nav-link",onClick:function(){return c("")},children:"Log Out"}):Object(b.jsx)(a.b,{to:"/account/login",className:"nav-link",children:"Login"})]})]}),Object(b.jsxs)("main",{children:[Object(b.jsx)(u.a,{exact:!0,path:"/",children:Object(b.jsx)(m,{user:O,token:s,messages:T,userId:F})}),Object(b.jsx)(u.a,{exact:!0,path:"/profile",children:Object(b.jsx)(N,{posts:w,token:s,setPosts:P,setMessages:I,messages:T,user:O,userId:F})}),Object(b.jsxs)(u.a,{exact:!0,path:"/posts",children:[s?Object(b.jsx)(h,{token:s,setPosts:P}):null,Object(b.jsx)(k,{posts:w,setPosts:P}),Object(b.jsx)("div",{className:"postdisplay",children:Object(b.jsx)(f,{posts:w,token:s,fetchPosts:A,setPosts:P})})]}),Object(b.jsx)(u.a,{exact:!0,path:"/posts/:postId",children:Object(b.jsx)("div",{className:"postdisplay",children:Object(b.jsx)(g,{posts:w,token:s})})}),Object(b.jsx)(u.a,{exact:!0,path:"/posts/edit/:postId",children:Object(b.jsx)("div",{className:"postdisplay",children:Object(b.jsx)(y,{posts:w,token:s,setPosts:P})})}),Object(b.jsx)(u.a,{exact:!0,path:"/account/:method",children:Object(b.jsx)(p,{setToken:c,setUser:x,setMessages:I,setUserId:M})})]}),Object(b.jsx)("footer",{})]})},x=function(e){var t=e.post,s=e.token,c=Object(n.useState)(""),r=Object(j.a)(c,2),a=r[0],o=r[1],p=Object(u.e)(),h=function(){var e=Object(i.a)(l.a.mark((function e(n){var c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),c="/posts/".concat(t._id,"/messages"),e.next=4,d({method:"POST",url:c,token:s,body:{message:{content:a}}});case 4:e.sent,p.push("./");case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(b.jsx)(b.Fragment,{children:s&&!t.isAuthor?Object(b.jsxs)("form",{className:"addmessage",onSubmit:h,children:[Object(b.jsx)("label",{children:"Compose Message:"}),Object(b.jsx)("input",{className:"addmessagelabel",value:a,placeholder:"content",onChange:function(e){return o(e.target.value)}}),Object(b.jsx)("button",{type:"submit",children:"Send Message"})]}):""})},m=function(e){var t=e.user,s=e.token,n=e.messages;e.userId;return console.log("messages: ",n),Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("h1",{className:"welcome",children:"Welcome to Stranger's Things"}),s?Object(b.jsxs)("div",{className:"welcomeuser",children:["You are logged in as ",t]}):""]})},f=function(e){var t=e.posts,s=e.token,n=e.fetchPosts,c=function(){var e=Object(i.a)(l.a.mark((function e(t){var c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d({method:"DELETE",url:"/posts/".concat(t),token:s});case 2:return c=e.sent,console.log("respObj: ",c),e.next=6,n();case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(b.jsx)(b.Fragment,{children:t.map((function(e){return Object(b.jsxs)(v,{post:e,token:s,children:[e&&Object(b.jsx)(a.b,{to:"/posts/".concat(e._id),className:"view-link",children:"View Post"}),e.isAuthor&&Object(b.jsx)(a.b,{to:"/posts/edit/".concat(e._id),className:"edit-link",children:"Edit"}),e.isAuthor&&Object(b.jsx)(a.b,{to:"/posts/delete/".concat(e._id),onClick:function(){return c(e._id)},className:"delete-link",children:"Delete"})]},e._id)}))})},v=function(e){var t=e.post,s=e.children;return t?Object(b.jsxs)("div",{style:{margin:"1.2rem"},children:[Object(b.jsx)("h5",{children:t.title}),Object(b.jsxs)("div",{children:["Description: ",t.description]}),Object(b.jsxs)("div",{children:["Price: ",t.price]}),Object(b.jsxs)("div",{children:["Seller: ",t.author.username]}),Object(b.jsxs)("div",{children:["Location: ",t.location]}),Object(b.jsxs)("div",{children:["Will Deliver: ",t.willDeliver?"yes":"no"]}),s]}):"Loading..."},g=function(e){var t=e.posts,s=e.token,n=Object(u.f)().postId;console.log("postId: ",n);var c=t.find((function(e){return e._id===n}));return console.log("post: ",c),Object(b.jsx)(b.Fragment,{children:Object(b.jsxs)(v,{post:c,children:[c&&c.messages&&c.messages.map((function(e){return Object(b.jsxs)("div",{children:[e.fromUser.username,": ",e.content," "]},e._id)})),Object(b.jsx)(x,{token:s,post:c})]})})};var k=function(e){var t=e.posts,s=e.setPosts,c=Object(n.useState)(""),r=Object(j.a)(c,2),a=r[0],o=r[1],u=function(){var e=Object(i.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,callApi({url:"/posts"});case 2:t=e.sent,(n=t.data.posts)&&s(n);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(b.jsx)(b.Fragment,{children:Object(b.jsxs)("form",{className:"searchbar",onSubmit:function(e){e.preventDefault(),function(){var e=t.filter((function(e){return function(e,t){return e.includes(t)}(e.title.toLowerCase(),a)}));s(e),a.length||u()}()},children:[Object(b.jsx)("input",{type:"text",placeholder:"search...",value:a,onChange:function(e){return o(e.target.value)}}),Object(b.jsx)("button",{type:"submit",children:"Search"})]})})},y=function(e){var t=e.token,s=e.setPosts,c=e.posts,r=Object(n.useState)(""),a=Object(j.a)(r,2),o=a[0],p=a[1],h=Object(n.useState)(""),O=Object(j.a)(h,2),x=O[0],m=O[1],f=Object(n.useState)(""),g=Object(j.a)(f,2),k=g[0],y=g[1],N=Object(n.useState)(""),S=Object(j.a)(N,2),w=S[0],P=S[1],C=Object(n.useState)(!1),D=Object(j.a)(C,2),T=D[0],I=D[1],U=Object(u.f)().postId,_=Object(u.e)(),F=c.find((function(e){return e._id===U})),M=function(){var e=Object(i.a)(l.a.mark((function e(n){var c,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),console.log({location:w,description:x}),e.next=4,d({url:"/posts/".concat(U),method:"PATCH",token:t,body:{post:{title:o,description:x,price:k,location:w,willDeliver:T}}});case 4:return c=e.sent,console.log("postResp: ",c),e.next=8,d({url:"/posts",token:t});case 8:r=e.sent,console.log("postsResp: ",r),s(r.data.posts),_.push("/posts");case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(v,{post:F}),Object(b.jsxs)("div",{className:"editform",children:[Object(b.jsx)("h1",{children:"Edit Post"}),Object(b.jsxs)("form",{onSubmit:M,children:[Object(b.jsxs)("fieldset",{children:[Object(b.jsx)("label",{className:"editformlabel",children:"Title: "}),Object(b.jsx)("input",{type:"text",placeholder:"".concat(F&&F.title),value:o,onChange:function(e){return p(e.target.value)}})]}),Object(b.jsxs)("fieldset",{children:[Object(b.jsx)("label",{className:"editformlabel",children:"Description: "}),Object(b.jsx)("input",{type:"text",placeholder:"".concat(F&&F.description),value:x,onChange:function(e){return m(e.target.value)}})]}),Object(b.jsxs)("fieldset",{children:[Object(b.jsx)("label",{className:"editformlabel",children:"Price: "}),Object(b.jsx)("input",{type:"text",placeholder:"".concat(F&&F.price),value:k,onChange:function(e){return y(e.target.value)}})]}),Object(b.jsxs)("fieldset",{children:[Object(b.jsx)("label",{className:"editformlabel",children:"Location: "}),Object(b.jsx)("input",{type:"text",placeholder:"".concat(F&&F.location),value:w,onChange:function(e){return P(e.target.value)}})]}),Object(b.jsxs)("fieldset",{children:[Object(b.jsx)("label",{className:"editformlabel",children:"Will Deliver: "}),Object(b.jsxs)("select",{type:"text",placeholder:"".concat(F&&F.willDeliver),value:T,onChange:function(e){return I(e.target.value)},children:[Object(b.jsx)("option",{value:"false",children:"No"}),Object(b.jsx)("option",{value:"true",children:"Yes"})]})]}),Object(b.jsx)("button",{type:"submit",children:"Add post"})]})]})]})},N=function(e){var t=e.token,s=e.messages,n=(e.user,e.userId);return Object(b.jsxs)("div",{children:[Object(b.jsx)("h1",{className:"messageview",children:"My Profile"}),t?Object(b.jsx)(b.Fragment,{children:Object(b.jsxs)("div",{children:[Object(b.jsx)("h3",{className:"messagereceived",children:"Messages Received"}),s.map((function(e,t){return console.log("message: ",e),Object(b.jsx)("div",{children:n!==e.fromUser._id?Object(b.jsxs)("div",{className:"messagereceivedsent",children:[e.post.title,": ",e.fromUser.username," replied: ",e.content]}):""},t)})),Object(b.jsx)("h3",{className:"messagesent",children:"Messages Sent"}),s.map((function(e,t){return console.log("message: ",e),Object(b.jsx)("div",{children:n===e.fromUser._id?Object(b.jsxs)("div",{className:"messagereceivedsent",children:[e.post.title,": ",e.fromUser.username," said: ",e.content]}):""},t)}))]})}):""]})};r.a.render(Object(b.jsx)(a.a,{children:Object(b.jsx)(O,{})}),document.querySelector("#app"))}},[[31,1,2]]]);
//# sourceMappingURL=main.5420612b.chunk.js.map